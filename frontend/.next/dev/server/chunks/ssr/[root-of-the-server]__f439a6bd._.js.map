{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///home/snoo/caravan-app/frontend/src/app/host/caravans/new/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport axios from \"axios\";\n\nexport default function NewCaravanPage() {\n  const router = useRouter();\n\n  // 입력 폼 상태 관리\n  const [name, setName] = useState(\"\");\n  const [description, setDescription] = useState(\"\");\n  const [location, setLocation] = useState(\"\");\n  const [pricePerNight, setPricePerNight] = useState(\"\");\n  const [capacity, setCapacity] = useState(\"\");\n  \n  // 로그인한 유저 정보 저장용\n  const [user, setUser] = useState<{ id: number; role: string } | null>(null);\n\n  // 1. 페이지 로드 시 로그인 정보 확인\n  useEffect(() => {\n    const storedUser = localStorage.getItem(\"user\");\n    if (!storedUser) {\n      alert(\"로그인이 필요합니다.\");\n      router.push(\"/auth/login\");\n      return;\n    }\n    const parsedUser = JSON.parse(storedUser);\n    \n    // 호스트 권한 체크\n    if (parsedUser.role !== \"HOST\") {\n      alert(\"호스트만 접근할 수 있습니다.\");\n      router.push(\"/\");\n      return;\n    }\n    \n    setUser(parsedUser);\n  }, [router]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    // 유저 정보가 없거나 ID가 없으면 중단\n    if (!user || !user.id) {\n      alert(\"로그인 정보가 올바르지 않습니다. 다시 로그인해주세요.\");\n      return;\n    }\n\n    try {\n      // 보낼 데이터 준비 (모든 숫자는 Number()로 확실하게 변환)\n      const payload = {\n        name,\n        description,\n        location,\n        pricePerDay: Number(pricePerNight), // 숫자 변환\n        capacity: Number(capacity),           // 숫자 변환\n        hostId: user.id,              // [중요] Host ID도 숫자로 변환\n        images: [\"https://placehold.co/600x400\"], \n      };\n\n      console.log(\"서버로 전송하는 데이터:\", payload); // 개발자 도구 콘솔에서 확인 가능\n\n      // API 호출\n      await axios.post(\"http://localhost:3001/api/caravans\", payload);\n\n      alert(\"카라반이 성공적으로 등록되었습니다!\");\n      router.push(\"/\"); // 등록 후 메인으로 이동\n\n    } catch (error: any) {\n      console.error(\"등록 실패 상세 로그:\", error);\n\n      // 백엔드가 보내준 구체적인 에러 메시지를 사용자에게 알림\n      if (error.response && error.response.data) {\n        // 객체를 문자열로 바꿔서 보여줌\n        alert(`등록 실패: ${JSON.stringify(error.response.data)}`);\n      } else {\n        alert(\"카라반 등록에 실패했습니다. (서버 응답 없음)\");\n      }\n    }\n  };\n\n  return (\n    <div className=\"max-w-xl mx-auto mt-10 p-6 bg-white shadow-lg rounded-lg border border-gray-200\">\n      <h1 className=\"text-2xl font-bold text-center mb-6 text-gray-800\">\n        내 카라반 등록하기\n      </h1>\n      \n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        <div>\n          <label className=\"block text-sm font-semibold text-gray-700 mb-1\">카라반 이름</label>\n          <input\n            type=\"text\"\n            value={name}\n            onChange={(e) => setName(e.target.value)}\n            className=\"w-full border p-2 rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            required\n            placeholder=\"예: 숲속 힐링 캠핑카\"\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-semibold text-gray-700 mb-1\">설명</label>\n          <textarea\n            value={description}\n            onChange={(e) => setDescription(e.target.value)}\n            className=\"w-full border p-2 rounded h-24 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            required\n            placeholder=\"카라반의 특징을 설명해주세요.\"\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-semibold text-gray-700 mb-1\">위치</label>\n          <input\n            type=\"text\"\n            value={location}\n            onChange={(e) => setLocation(e.target.value)}\n            className=\"w-full border p-2 rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            required\n            placeholder=\"예: 강원도 춘천\"\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-semibold text-gray-700 mb-1\">1박 가격 (원)</label>\n          <input\n            type=\"number\"\n            value={pricePerNight}\n            onChange={(e) => setPricePerNight(e.target.value)}\n            className=\"w-full border p-2 rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            required\n            placeholder=\"예: 150000\"\n          />\n        </div>\n\n        <div>\n          <label className=\"block text-sm font-semibold text-gray-700 mb-1\">수용 인원</label>\n          <input\n            type=\"number\"\n            value={capacity}\n            onChange={(e) => setCapacity(e.target.value)}\n            className=\"w-full border p-2 rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            required\n            placeholder=\"예: 4\"\n          />\n        </div>\n\n        <button\n          type=\"submit\"\n          className=\"w-full bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 transition\"\n        >\n          등록하기\n        </button>\n      </form>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}