{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///home/snoo/caravan-app/frontend/src/app/caravans/new/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\n// next/navigation 모듈 오류 방지를 위해 window.location 사용\n// import { useRouter } from 'next/navigation'; \n// next/link 모듈 오류 방지를 위해 a 태그 사용\n// import Link from 'next/link';\n\nexport default function NewCaravanPage() {\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  // 폼 상태 관리\n  const [formData, setFormData] = useState({\n    name: '',\n    location: '',\n    pricePerDay: '',\n    capacity: '',\n    description: '',\n    imageUrls: '', // 쉼표로 구분하여 입력\n  });\n\n  // 호스트 권한 체크 (페이지 진입 시)\n  useEffect(() => {\n    const userStr = localStorage.getItem('user');\n    if (!userStr) {\n      alert('로그인이 필요합니다.');\n      if (typeof window !== 'undefined') {\n        window.location.href = `${window.location.origin}/auth/login`;\n      }\n      return;\n    }\n    const user = JSON.parse(userStr);\n    if (user.role !== 'HOST') {\n      alert('호스트 권한이 필요합니다.');\n      if (typeof window !== 'undefined') {\n        window.location.href = `${window.location.origin}/`;\n      }\n    }\n  }, []);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value } = e.target;\n    setFormData((prev) => ({\n      ...prev,\n      [name]: value,\n    }));\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n\n    try {\n      // 로컬 스토리지에서 호스트 ID 가져오기\n      const userStr = localStorage.getItem('user');\n      if (!userStr) throw new Error('로그인 정보가 없습니다.');\n      const user = JSON.parse(userStr);\n\n      // 데이터 가공\n      const payload = {\n        hostId: user.id,\n        name: formData.name,\n        location: formData.location,\n        pricePerDay: Number(formData.pricePerDay),\n        capacity: Number(formData.capacity),\n        description: formData.description,\n        // 쉼표로 구분된 이미지 URL을 배열로 변환 및 공백 제거\n        images: formData.imageUrls.split(',').map((url) => url.trim()).filter((url) => url !== ''),\n      };\n\n      // 백엔드 요청\n      const response = await axios.post('/api/caravans', payload);\n\n      if (response.status === 201) {\n        alert('카라반이 성공적으로 등록되었습니다!');\n        if (typeof window !== 'undefined') {\n          window.location.href = `${window.location.origin}/my/profile`; // 등록 후 내 프로필이나 목록으로 이동\n        }\n      }\n    } catch (err: any) {\n      console.error('등록 실패:', err);\n      // 에러 메시지가 객체일 경우를 대비해 문자열로 변환\n      const errorMsg = err.response?.data?.message;\n      setError(typeof errorMsg === 'string' ? errorMsg : JSON.stringify(errorMsg) || '카라반 등록 중 오류가 발생했습니다.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-10\">\n      <h1 className=\"text-3xl font-bold text-gray-900 mb-8\">새 카라반 등록</h1>\n\n      <form onSubmit={handleSubmit} className=\"space-y-6 bg-white p-8 rounded-lg shadow-sm border border-gray-200\">\n        \n        {/* 카라반 이름 */}\n        <div>\n          <label htmlFor=\"name\" className=\"block text-sm font-medium text-gray-700\">카라반 이름</label>\n          <input\n            type=\"text\"\n            name=\"name\"\n            id=\"name\"\n            required\n            value={formData.name}\n            onChange={handleChange}\n            className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border\"\n            placeholder=\"예: 숲속 힐링 캠핑카\"\n          />\n        </div>\n\n        {/* 위치 */}\n        <div>\n          <label htmlFor=\"location\" className=\"block text-sm font-medium text-gray-700\">위치 (지역)</label>\n          <input\n            type=\"text\"\n            name=\"location\"\n            id=\"location\"\n            required\n            value={formData.location}\n            onChange={handleChange}\n            className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border\"\n            placeholder=\"예: 강원도 춘천\"\n          />\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          {/* 1박 가격 */}\n          <div>\n            <label htmlFor=\"pricePerDay\" className=\"block text-sm font-medium text-gray-700\">1박 요금 (원)</label>\n            <input\n              type=\"number\"\n              name=\"pricePerDay\"\n              id=\"pricePerDay\"\n              required\n              min=\"0\"\n              value={formData.pricePerDay}\n              onChange={handleChange}\n              className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border\"\n              placeholder=\"50000\"\n            />\n          </div>\n\n          {/* 수용 인원 */}\n          <div>\n            <label htmlFor=\"capacity\" className=\"block text-sm font-medium text-gray-700\">최대 수용 인원 (명)</label>\n            <input\n              type=\"number\"\n              name=\"capacity\"\n              id=\"capacity\"\n              required\n              min=\"1\"\n              value={formData.capacity}\n              onChange={handleChange}\n              className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border\"\n              placeholder=\"4\"\n            />\n          </div>\n        </div>\n\n        {/* 설명 */}\n        <div>\n          <label htmlFor=\"description\" className=\"block text-sm font-medium text-gray-700\">상세 설명</label>\n          <textarea\n            name=\"description\"\n            id=\"description\"\n            rows={4}\n            required\n            value={formData.description}\n            onChange={handleChange}\n            className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border\"\n            placeholder=\"카라반의 특징과 장점을 설명해주세요.\"\n          />\n        </div>\n\n        {/* 이미지 URL */}\n        <div>\n          <label htmlFor=\"imageUrls\" className=\"block text-sm font-medium text-gray-700\">이미지 URL (콤마로 구분)</label>\n          <input\n            type=\"text\"\n            name=\"imageUrls\"\n            id=\"imageUrls\"\n            required\n            value={formData.imageUrls}\n            onChange={handleChange}\n            className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2 border\"\n            placeholder=\"https://example.com/image1.jpg, https://example.com/image2.jpg\"\n          />\n          <p className=\"mt-1 text-xs text-gray-500\">\n            * 실제 이미지 파일 업로드는 추후 구현 예정입니다. 현재는 이미지 주소를 입력해주세요.\n            (테스트용: https://placehold.co/600x400)\n          </p>\n        </div>\n\n        {/* 에러 메시지 */}\n        {error && (\n          <div className=\"text-red-600 text-sm bg-red-50 p-3 rounded-md border border-red-200\">\n            ⚠️ {error}\n          </div>\n        )}\n\n        {/* 제출 버튼 */}\n        <div className=\"flex justify-end pt-4\">\n          <button\n            type=\"button\"\n            onClick={() => window.history.back()}\n            className=\"mr-3 px-4 py-2 bg-white border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\n          >\n            취소\n          </button>\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className={`px-6 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 ${loading ? 'opacity-50 cursor-not-allowed' : ''}`}\n          >\n            {loading ? '등록 중...' : '카라반 등록하기'}\n          </button>\n        </div>\n\n      </form>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}