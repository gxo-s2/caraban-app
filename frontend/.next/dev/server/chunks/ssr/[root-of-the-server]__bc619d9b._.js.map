{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///home/snoo/caravan-app/frontend/src/app/my/reservations/page.tsx"],"sourcesContent":["'use client'; // ✅ 이 선언은 반드시 파일의 맨 꼭대기에 있어야 합니다.\n\nimport { useEffect, useState } from 'react';\nimport axios from 'axios';\n// import Link from 'next/link'; // 오류 발생으로 제거하고 a 태그로 대체\n\n// 예약 데이터 타입 정의\ninterface Reservation {\n  id: string; // 예약 번호 (UUID)\n  startDate: string;\n  endDate: string;\n  totalPrice: number;\n  status: 'PENDING' | 'CONFIRMED' | 'CANCELLED';\n  caravan: {\n    id: string;\n    name: string;\n    location: string;\n    pricePerDay: number;\n    images: string[];\n  };\n}\n\nexport default function MyReservationsPage() {\n  const [reservations, setReservations] = useState<Reservation[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n\n  // 데이터 불러오기\n  useEffect(() => {\n    const fetchReservations = async () => {\n      try {\n        // 로컬 스토리지에서 유저 정보 가져오기\n        const userStr = localStorage.getItem('user');\n        if (!userStr) {\n          setError('로그인이 필요합니다.');\n          setLoading(false);\n          return;\n        }\n\n        const user = JSON.parse(userStr);\n        // API 요청\n        const response = await axios.get(`/api/reservations/user/${user.id}`);\n        setReservations(response.data);\n      } catch (err: any) {\n        console.error('예약 불러오기 실패:', err);\n        setError('예약 내역을 불러오는데 실패했습니다.');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchReservations();\n  }, []);\n\n  // ✅ 예약 번호 복사 핸들러\n  const handleCopyId = (id: string) => {\n    navigator.clipboard.writeText(id).then(() => {\n      alert(`예약 번호가 복사되었습니다!\\n${id}`);\n    }).catch(() => {\n      alert('복사에 실패했습니다. 직접 복사해 주세요.');\n    });\n  };\n\n  // 날짜 포맷팅 함수\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('ko-KR', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n    });\n  };\n\n  // 가격 포맷팅 함수\n  const formatPrice = (price: number) => {\n    return new Intl.NumberFormat('ko-KR', {\n      style: 'currency',\n      currency: 'KRW',\n    }).format(price);\n  };\n\n  // 상태 뱃지 컴포넌트\n  const StatusBadge = ({ status }: { status: string }) => {\n    const styles = {\n      PENDING: 'bg-yellow-100 text-yellow-800',\n      CONFIRMED: 'bg-green-100 text-green-800',\n      CANCELLED: 'bg-red-100 text-red-800',\n    };\n    const labels = {\n      PENDING: '대기중',\n      CONFIRMED: '예약 확정',\n      CANCELLED: '취소됨',\n    };\n\n    const statusKey = status as keyof typeof styles;\n\n    return (\n      <span className={`px-2 py-1 rounded-full text-xs font-semibold ${styles[statusKey] || 'bg-gray-100 text-gray-800'}`}>\n        {labels[statusKey] || status}\n      </span>\n    );\n  };\n\n  if (loading) {\n    return (\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10\">\n        <h1 className=\"text-2xl font-bold mb-6\">내 예약 목록</h1>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {[1, 2, 3].map((i) => (\n            <div key={i} className=\"bg-white rounded-lg shadow-md p-4 animate-pulse h-80\">\n              <div className=\"bg-gray-200 h-40 rounded-md mb-4\"></div>\n              <div className=\"h-4 bg-gray-200 rounded w-3/4 mb-2\"></div>\n              <div className=\"h-4 bg-gray-200 rounded w-1/2\"></div>\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10\">\n      <h1 className=\"text-2xl font-bold mb-8\">내 예약 목록</h1>\n\n      {error ? (\n        <div className=\"text-center py-20\">\n          <p className=\"text-red-500 mb-4\">{error}</p>\n          <a href=\"/auth/login\" className=\"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700\">\n            로그인 페이지로\n          </a>\n        </div>\n      ) : reservations.length === 0 ? (\n        <div className=\"text-center py-20 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300\">\n          <p className=\"text-gray-500 text-lg mb-6\">아직 예약된 여행이 없습니다.</p>\n          <a href=\"/caravans\" className=\"px-6 py-3 bg-indigo-600 text-white rounded-md font-medium hover:bg-indigo-700 transition-colors\">\n            카라반 구경하러 가기\n          </a>\n        </div>\n      ) : (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n          {reservations.map((reservation) => (\n            <div key={reservation.id} className=\"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow\">\n              \n              {/* 카드 이미지 영역 */}\n              <div className=\"relative h-48 bg-gray-200\">\n                <img\n                  // ✅ [수정됨] 안전한 접근: images가 없거나(undefined) 비어있어도 에러 없이 기본 이미지를 보여줍니다.\n                  src={reservation.caravan.images?.[0] || 'https://via.placeholder.com/400x300?text=No+Image'}\n                  alt={reservation.caravan.name}\n                  className=\"w-full h-full object-cover\"\n                />\n                <div className=\"absolute top-3 right-3\">\n                  <StatusBadge status={reservation.status} />\n                </div>\n              </div>\n\n              {/* 카드 내용 영역 */}\n              <div className=\"p-5\">\n                {/* ✅ 예약 번호 및 복사 버튼 */}\n                <div className=\"flex items-center justify-between mb-3 bg-gray-50 p-2 rounded-md\">\n                  <div className=\"flex flex-col\">\n                    <span className=\"text-[10px] text-gray-500 uppercase tracking-wider\">Reservation ID</span>\n                    <span className=\"text-xs font-mono text-gray-700 truncate w-40\" title={reservation.id}>\n                      {reservation.id}\n                    </span>\n                  </div>\n                  <button\n                    onClick={() => handleCopyId(reservation.id)}\n                    className=\"text-gray-400 hover:text-indigo-600 transition-colors p-1\"\n                    title=\"예약 번호 복사\"\n                  >\n                    {/* 복사 아이콘 (SVG) */}\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1.5} stroke=\"currentColor\" className=\"w-4 h-4\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-3.5m7.5-10.375H9.375a1.125 1.125 0 01-1.125-1.125v-3.5\" />\n                    </svg>\n                    <span className=\"text-xs ml-1\">복사</span>\n                  </button>\n                </div>\n\n                <h3 className=\"text-lg font-bold text-gray-900 mb-1\">{reservation.caravan.name}</h3>\n                <p className=\"text-sm text-gray-500 mb-4 flex items-center\">\n                  <svg className=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z\" />\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M15 11a3 3 0 11-6 0 3 3 0 016 0z\" />\n                  </svg>\n                  {reservation.caravan.location}\n                </p>\n\n                <div className=\"border-t border-gray-100 pt-4 space-y-2\">\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-gray-500\">예약 날짜</span>\n                    <span className=\"text-gray-900 font-medium\">\n                      {formatDate(reservation.startDate)} ~ {formatDate(reservation.endDate)}\n                    </span>\n                  </div>\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-gray-500\">총 결제 금액</span>\n                    <span className=\"text-indigo-600 font-bold text-lg\">\n                      {formatPrice(reservation.totalPrice)}\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}