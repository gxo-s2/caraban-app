{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///home/snoo/caravan-app/frontend/src/app/my/payments/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport axios from \"axios\"; // axios ÎåÄÏã† fetchÎ•º ÏÇ¨Ïö©Ìï¥ÎèÑ ÎêòÏßÄÎßå, ÏùºÍ¥ÄÏÑ±ÏùÑ ÏúÑÌï¥ axiosÎ•º ÏÇ¨Ïö©Ìï©ÎãàÎã§.\n\n// Î∞±ÏóîÎìú Îç∞Ïù¥ÌÑ∞ ÌÉÄÏûÖ Ï†ïÏùò\ntype PaymentStatus = 'COMPLETED' | 'PENDING' | 'FAILED'; // Prisma StatusÏôÄ ÏùºÏπòÌïòÎèÑÎ°ù Ï†ïÏùò\n\ninterface Caravan {\n    name: string;\n    location: string;\n}\n\ninterface Reservation {\n    id: string;\n    caravan: Caravan;\n}\n\ninterface Payment {\n    id: string;\n    amount: number;\n    method: string;\n    status: PaymentStatus;\n    createdAt: string; // Í≤∞Ï†úÏùºÏãú (PrismaÏùò Í∏∞Î≥∏ ÌïÑÎìú)\n    reservation: Reservation;\n}\n\nexport default function PaymentHistoryPage() {\n    const [payments, setPayments] = useState<Payment[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState<string | null>(null);\n    const [userId, setUserId] = useState<string | null>(null);\n    const router = useRouter();\n\n    const API_URL = \"http://localhost:3001/api/payments\";\n\n    useEffect(() => {\n        // 1. Î°úÍ∑∏Ïù∏ Ï≤¥ÌÅ¨ Î∞è userId Ï∂îÏ∂ú\n        const userJson = localStorage.getItem(\"user\");\n        \n        if (!userJson) {\n            router.push(\"/auth/login\");\n            return;\n        }\n        \n        try {\n            const user = JSON.parse(userJson);\n            // Host IDÏôÄ ÎßàÏ∞¨Í∞ÄÏßÄÎ°ú UUID Î¨∏ÏûêÏó¥Ïù¥ÎØÄÎ°ú stringÏúºÎ°ú ÏÇ¨Ïö©\n            const extractedUserId = user.id; \n            \n            if (!extractedUserId) {\n                router.push(\"/auth/login\"); \n                return;\n            }\n            \n            setUserId(extractedUserId);\n            fetchPayments(extractedUserId);\n            \n        } catch (e) {\n            router.push(\"/auth/login\");\n        }\n    }, [router]);\n\n\n    async function fetchPayments(currentUserId: string) {\n        try {\n            // üö® [ÌïµÏã¨ ÏàòÏ†ï] URL Í≤ΩÎ°ú Ïò§Î•ò Ï†úÍ±∞ Î∞è userIdÎ•º ÏøºÎ¶¨ ÌååÎùºÎØ∏ÌÑ∞Î°úÎßå Ï†ïÌôïÌïòÍ≤å Ï†ÑÎã¨\n            const res = await axios.get(`${API_URL}?userId=${currentUserId}`);\n            \n            if (res.status !== 200) {\n                throw new Error('Failed to fetch payments.');\n            }\n            \n            setPayments(res.data);\n            \n        } catch (err: any) {\n            console.error(\"Payment Fetch Error:\", err);\n            setError(\"Failed to fetch payments. Check backend API or server status.\");\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    // ÏÉÅÌÉúÏóê Îî∞Î•∏ Î∞∞ÏßÄ Ïä§ÌÉÄÏùºÎßÅ\n    const getStatusBadge = (status: PaymentStatus) => {\n        let colorClass = \"\";\n        switch (status) {\n            case \"COMPLETED\":\n                colorClass = \"bg-green-100 text-green-800\";\n                break;\n            case \"PENDING\":\n                colorClass = \"bg-yellow-100 text-yellow-800\";\n                break;\n            case \"FAILED\":\n                colorClass = \"bg-red-100 text-red-800\";\n                break;\n            default:\n                colorClass = \"bg-gray-100 text-gray-800\";\n        }\n        return (\n            <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${colorClass}`}>\n                {status}\n            </span>\n        );\n    };\n\n\n    if (loading) return <div className=\"text-center py-20\">Í≤∞Ï†ú Ïù¥Î†•ÏùÑ Î∂àÎü¨Ïò§Îäî Ï§ë...</div>;\n    if (error) return <p className=\"text-center py-20 text-red-500 font-bold\">{error}</p>;\n\n\n    return (\n        <div className=\"max-w-7xl mx-auto p-6\">\n            <h1 className=\"text-3xl font-bold mb-6 text-gray-800\">Í≤∞Ï†ú Ïù¥Î†• Ï°∞Ìöå</h1>\n            \n            {payments.length === 0 ? (\n                <div className=\"text-center py-20 bg-gray-50 rounded-lg\">\n                    <p className=\"text-gray-500 text-lg\">Í≤∞Ï†ú Ïù¥Î†•Ïù¥ ÏóÜÏäµÎãàÎã§.</p>\n                </div>\n            ) : (\n                <div className=\"overflow-x-auto shadow-md sm:rounded-lg\">\n                    <table className=\"min-w-full divide-y divide-gray-200\">\n                        <thead className=\"bg-gray-50\">\n                            <tr>\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Í±∞Îûò ID</th>\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Ïπ¥ÎùºÎ∞ò Ïù¥Î¶Ñ</th>\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Í≤∞Ï†ú Í∏àÏï°</th>\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Í≤∞Ï†úÏùºÏãú</th>\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">ÏÉÅÌÉú</th>\n                            </tr>\n                        </thead>\n                        <tbody className=\"bg-white divide-y divide-gray-200\">\n                            {payments.map((payment) => (\n                                <tr key={payment.id}>\n                                    <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 truncate max-w-xs\">{payment.id}</td>\n                                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                                        {payment.reservation?.caravan?.name || 'N/A'}\n                                    </td>\n                                    <td className=\"px-6 py-4 whitespace-nowrap text-sm font-bold text-indigo-600\">\n                                        ‚Ç©{payment.amount.toLocaleString()}\n                                    </td>\n                                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                                        {new Date(payment.createdAt).toLocaleDateString()}\n                                    </td>\n                                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                                        {getStatusBadge(payment.status)}\n                                    </td>\n                                </tr>\n                            ))}\n                        </tbody>\n                    </table>\n                </div>\n            )}\n        </div>\n    );\n}"],"names":[],"mappings":"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"}}]
}