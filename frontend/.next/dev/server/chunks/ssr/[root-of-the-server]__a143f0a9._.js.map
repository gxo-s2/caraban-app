{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///home/snoo/caravan-app/frontend/src/app/host/reservations/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport axios from \"axios\";\n\n// ÌÉÄÏûÖ Ï†ïÏùò (Î∞±ÏóîÎìú ÏùëÎãµ Íµ¨Ï°∞ÏôÄ ÏùºÏπòÌï¥Ïïº Ìï©ÎãàÎã§.)\ntype ReservationStatus = \"PENDING\" | \"CONFIRMED\" | \"CANCELLED\";\n\ninterface Caravan {\n  id: string;\n  name: string;\n  location: string;\n}\n\ninterface User {\n  id: string;\n  name: string;\n  email: string;\n}\n\ninterface Reservation {\n  id: string;\n  startDate: string;\n  endDate: string;\n  totalPrice: number;\n  status: ReservationStatus;\n  caravan: Caravan; // include Îêú Ïπ¥ÎùºÎ∞ò Ï†ïÎ≥¥\n  guest: User;    // include Îêú Í≤åÏä§Ìä∏ Ï†ïÎ≥¥\n  hostId: string;\n}\n\nexport default function HostReservationPage() {\n  const router = useRouter();\n  const [reservations, setReservations] = useState<Reservation[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [hostUser, setHostUser] = useState<User & { role: string } | null>(null);\n\n  // Î∞±ÏóîÎìú API Ï£ºÏÜå\n  const API_URL = \"http://localhost:3001/api/reservations\";\n\n  useEffect(() => {\n    // 1. Î°úÍ∑∏Ïù∏ Î∞è Í∂åÌïú Ï≤¥ÌÅ¨\n    const storedUser = localStorage.getItem(\"user\");\n    if (!storedUser) {\n      alert(\"Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.\");\n      router.push(\"/auth/login\");\n      return;\n    }\n\n    const parsedUser = JSON.parse(storedUser);\n    \n    if (parsedUser.role !== \"HOST\") {\n      alert(\"Ìò∏Ïä§Ìä∏Îßå Ï†ëÍ∑ºÌï† Ïàò ÏûàÏäµÎãàÎã§.\");\n      router.push(\"/\");\n      return;\n    }\n\n    setHostUser(parsedUser);\n    \n    // 2. ÏòàÏïΩ Î™©Î°ù Î°úÎìú ÏãúÏûë\n    fetchReservations(parsedUser.id);\n\n  }, [router]);\n\n  // ÏòàÏïΩ Î™©Î°ù Ï°∞Ìöå Ìï®Ïàò\n  const fetchReservations = async (hostId: string) => {\n    setLoading(true);\n    try {\n      // üö® [ÌïµÏã¨] ÏÉàÎ°ú Íµ¨ÌòÑÌïú Ìò∏Ïä§Ìä∏Ïö© API Ìò∏Ï∂ú: GET /api/reservations/host/:hostId\n      const response = await axios.get(`${API_URL}/host/${hostId}`);\n      \n      setReservations(response.data);\n      \n    } catch (err: any) {\n      console.error(\"ÏòàÏïΩ Î™©Î°ù Î°úÎî© Ïã§Ìå®:\", err);\n      setError(`ÏòàÏïΩ Ï†ïÎ≥¥Î•º Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§. (Error: ${err.response?.status || err.message})`);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // ÏòàÏïΩ ÏÉÅÌÉú Î≥ÄÍ≤Ω Ìï∏Îì§Îü¨ (ÏäπÏù∏ ÎòêÎäî Í±∞Ï†à) - PATCH APIÍ∞Ä Íµ¨ÌòÑÎêòÏóàÎã§Í≥† Í∞ÄÏ†ï\n  const handleUpdateStatus = async (reservationId: string, newStatus: \"CONFIRMED\" | \"CANCELLED\") => {\n    const action = newStatus === \"CONFIRMED\" ? \"ÏäπÏù∏\" : \"Í±∞Ï†à\";\n    if (!confirm(`ÏòàÏïΩÏùÑ ${action}ÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) return;\n\n    try {\n      // PATCH /api/reservations/:id/status API Ìò∏Ï∂ú (Ï∂îÌõÑ Íµ¨ÌòÑ ÏòàÏ†ï)\n      await axios.patch(`${API_URL}/${reservationId}/status`, {\n        status: newStatus,\n        hostId: hostUser?.id, // Í∂åÌïú Í≤ÄÏ¶ùÏùÑ ÏúÑÌï¥ Ìò∏Ïä§Ìä∏ ID Ï†ÑÏÜ°\n      });\n\n      alert(`ÏòàÏïΩÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ${action}ÎêòÏóàÏäµÎãàÎã§.`);\n      \n      // ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏ ÌõÑ Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®\n      if (hostUser) fetchReservations(hostUser.id);\n      \n    } catch (err: any) {\n      console.error(`${action} Ïã§Ìå®:`, err);\n      alert(`ÏòàÏïΩ ${action} Ï≤òÎ¶¨Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§. (Ïò§Î•ò: ${err.response?.data?.message || err.message})`);\n    }\n  };\n\n  // ÏÉÅÌÉúÏóê Îî∞Î•∏ Î∞∞ÏßÄ Ïä§ÌÉÄÏùºÎßÅ\n  const getStatusBadge = (status: ReservationStatus) => {\n    let colorClass = \"\";\n    let statusText = \"\";\n\n    switch (status) {\n      case \"PENDING\":\n        colorClass = \"bg-yellow-100 text-yellow-800\";\n        statusText = \"ÎåÄÍ∏∞ Ï§ë\";\n        break;\n      case \"CONFIRMED\":\n        colorClass = \"bg-green-100 text-green-800\";\n        statusText = \"ÏòàÏïΩ ÌôïÏ†ï\";\n        break;\n      case \"CANCELLED\":\n        colorClass = \"bg-red-100 text-red-800\";\n        statusText = \"ÏòàÏïΩ Ï∑®ÏÜå\";\n        break;\n      default:\n        colorClass = \"bg-gray-100 text-gray-800\";\n        statusText = \"Ïïå Ïàò ÏóÜÏùå\";\n    }\n    return (\n      <span className={`inline-flex items-center px-3 py-0.5 rounded-full text-sm font-medium ${colorClass}`}>\n        {statusText}\n      </span>\n    );\n  };\n\n  if (loading) return <div className=\"text-center py-20\">ÏòàÏïΩ Î™©Î°ùÏùÑ Î∂àÎü¨Ïò§Îäî Ï§ë...</div>;\n  if (error) return <p className=\"text-center py-20 text-red-500 font-bold\">Ïò§Î•ò: {error}</p>;\n  if (!hostUser) return null; // Î°úÎî© Ï§ë Í∂åÌïú ÏóÜÎäî Í≤ΩÏö∞\n\n  return (\n    <div className=\"max-w-7xl mx-auto p-6\">\n      <h1 className=\"text-3xl font-bold mb-8 text-gray-800\">\n        Ïπ¥ÎùºÎ∞ò ÏòàÏïΩ Í¥ÄÎ¶¨ ÎåÄÏãúÎ≥¥Îìú ({hostUser.name}Îãò)\n      </h1>\n\n      {reservations.length === 0 ? (\n        <div className=\"text-center py-20 bg-gray-50 rounded-lg\">\n          <p className=\"text-gray-500 text-lg\">ÎÇ¥ Ïπ¥ÎùºÎ∞òÏóê Îì§Ïñ¥Ïò® ÏòàÏïΩ ÏöîÏ≤≠Ïù¥ ÏóÜÏäµÎãàÎã§.</p>\n          <p className=\"text-sm text-gray-400 mt-2\">ÏÉàÎ°úÏö¥ ÏòàÏïΩ ÏöîÏ≤≠Ïù¥ Îì§Ïñ¥Ïò§Î©¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§.</p>\n        </div>\n      ) : (\n        <div className=\"space-y-6\">\n          {reservations.map((reservation) => (\n            <div\n              key={reservation.id}\n              className=\"bg-white border border-gray-200 rounded-xl shadow-md p-6 flex flex-col lg:flex-row justify-between items-start lg:items-center hover:shadow-lg transition\"\n            >\n              {/* ÏòàÏïΩ Ï†ïÎ≥¥ ÏòÅÏó≠ */}\n              <div className=\"flex-1 space-y-2 lg:space-y-0 lg:flex lg:space-x-8 items-center w-full\">\n                \n                {/* ÏÉÅÌÉú Î∞∞ÏßÄ */}\n                <div className=\"lg:w-32 flex-shrink-0 mb-3 lg:mb-0\">\n                  {getStatusBadge(reservation.status)}\n                </div>\n\n                {/* ÏÉÅÏÑ∏ ÎÇ¥Ïö© */}\n                <div className=\"flex-1 min-w-0\">\n                    <p className=\"text-lg font-semibold text-gray-800 truncate\">{reservation.caravan.name}</p>\n                    <p className=\"text-sm text-gray-500\">\n                        <span className=\"font-medium text-gray-700\">Í≤åÏä§Ìä∏:</span> {reservation.guest?.name || \"ÏùµÎ™Ö\"} ({reservation.guest?.email})\n                    </p>\n                    <p className=\"text-sm text-gray-500\">\n                        <span className=\"font-medium text-gray-700\">Í∏∞Í∞Ñ:</span> {new Date(reservation.startDate).toLocaleDateString()} ~ {new Date(reservation.endDate).toLocaleDateString()}\n                    </p>\n                </div>\n\n                {/* Í∞ÄÍ≤© Ï†ïÎ≥¥ */}\n                <div className=\"lg:w-40 flex-shrink-0 text-left lg:text-right mt-3 lg:mt-0\">\n                    <p className=\"text-sm font-medium text-gray-500\">Ï¥ù Í∏àÏï°</p>\n                    <p className=\"text-xl font-bold text-green-600\">‚Ç©{reservation.totalPrice.toLocaleString()}</p>\n                </div>\n              </div>\n\n              {/* Ïï°ÏÖò Î≤ÑÌäº ÏòÅÏó≠ */}\n              <div className=\"mt-5 lg:mt-0 flex flex-col space-y-2 lg:flex-row lg:space-x-2 lg:space-y-0 flex-shrink-0\">\n                {reservation.status === \"PENDING\" ? (\n                  <>\n                    <button\n                      onClick={() => handleUpdateStatus(reservation.id, \"CONFIRMED\")}\n                      className=\"bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-green-600 transition w-full lg:w-auto\"\n                    >\n                      ÏòàÏïΩ ÏäπÏù∏\n                    </button>\n                    <button\n                      onClick={() => handleUpdateStatus(reservation.id, \"CANCELLED\")}\n                      className=\"bg-red-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-red-600 transition w-full lg:w-auto\"\n                    >\n                      ÏòàÏïΩ Í±∞Ï†à\n                    </button>\n                  </>\n                ) : (\n                  <button\n                    disabled\n                    className=\"bg-gray-100 text-gray-500 px-4 py-2 rounded-lg text-sm cursor-not-allowed w-full lg:w-auto\"\n                  >\n                    Ï≤òÎ¶¨ ÏôÑÎ£å\n                  </button>\n                )}\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}